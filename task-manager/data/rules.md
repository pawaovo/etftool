# Development Guidelines

## 1. Project Overview

- **Purpose**: Web application for processing and visualizing ETF data.
- **Tech Stack**: HTML, CSS, JavaScript (Vanilla JS, Node.js for tooling), Python (specific scripts).

## 2. Directory Structure

- `.` : Root directory. Contains configuration files (`package.json`, `vercel.json`), HTML pages, main scripts.
- `api/`: Serverless functions (if any, needs confirmation).
- `css/`, `styles/`: CSS stylesheets. **Use `styles/` primarily.**
- `data/`: Raw data files (e.g., `.json`).
- `dist/`: Build output directory. **DO NOT EDIT MANUALLY.**
- `docs/`: Documentation files.
- `etftool/`: Python related code (needs confirmation).
- `js/`: JavaScript files (potentially legacy or third-party). **Prefer placing new JS logic directly in HTML or dedicated component files if structure evolves.**
- `node_modules/`: Project dependencies. **DO NOT EDIT MANUALLY.**
- `public/`: Static assets served directly or build output.
- `scripts/`: Build, processing, or utility scripts (Node.js).
- `src/`: Main source code (if project adopts this structure). **Currently, most logic is in root JS/HTML files.**
- `task-manager/`: Internal data for this agent. **DO NOT EDIT MANUALLY unless instructed.**

## 3. Coding Standards

### 3.1 JavaScript (JS)

- **Formatting**: **MUST** use Prettier with default settings. Run `npx prettier --write .` before committing (or configure editor integration).
- **Naming**: **MUST** use `camelCase` for variables and functions.
- **Variables**: **MUST** use `const` by default. Use `let` only if reassignment is necessary. **DO NOT** use `var`.
- **Modularity**: Keep functions focused on a single task. Avoid overly long functions.
- **Frameworks**: **DO NOT** introduce jQuery, React, Vue, or other large frameworks unless explicitly requested and approved. Keep codebase primarily Vanilla JS.
- **Global Scope**: Minimize global variables. Use module patterns (IIFE) or ES Modules if applicable for structuring.

### 3.2 CSS

- **Naming**: **MUST** use BEM (Block, Element, Modifier) naming convention (e.g., `.block__element--modifier`).
- **Organization**: Place general styles in `styles/styles.css`. Component-specific styles can be co-located if structure changes, otherwise use clear BEM blocks.
- **Units**: Prefer relative units (`rem`, `em`, `%`) over pixels (`px`) where appropriate for scalability.

### 3.3 HTML

- **Semantics**: **MUST** use semantic HTML5 tags (`<article>`, `<nav>`, `<aside>`, etc.) where appropriate.
- **Accessibility**: Ensure basic accessibility (e.g., `alt` attributes for images, proper label associations).
- **Indentation**: **MUST** maintain consistent indentation (2 spaces recommended).

### 3.4 Python

- **Formatting**: **MUST** follow PEP 8 guidelines. Use tools like `black` or `flake8`.

## 4. Data Handling

- **Raw Data**: Files like `etf.json`, `adjust.json`, `class-distribution.json` are in the `data/` directory (or root).
- **Processed Data**: `processed-data.js` (or similar) is generated. **DO NOT EDIT THIS FILE DIRECTLY.**
- **Update Process**:
    1. Modify the raw `.json` data files in `data/` (or root).
    2. **MUST** run the designated processing script (e.g., `node process-data.js` - **confirm exact command in `package.json`**) to update `processed-data.js`.

## 5. Charts and Visualization

- **Primary Library**: `asset-distribution-chart.js` seems to be a key file. Modifications to chart logic happen here or in related JS files.
- **Data Source**: Charts typically consume data from `processed-data.js` or variables derived from it.
- **Adding Charts**: Follow existing patterns. Encapsulate chart logic. Ensure data is processed correctly before rendering.

## 6. Core HTML Files

- **Main Pages**: `splan.html`, `150plan.html`, `asset-ratio.html` contain primary user-facing content.
- **Structure**: When modifying these files, **MUST** maintain the existing HTML structure and element IDs/classes unless refactoring is the goal.
- **Templates**: `page-template.html` might serve as a base. **Verify** its usage before creating new pages.

## 7. Build, Deployment, and Local Execution

- **Scripts**: Check `package.json` for available scripts (`npm run <script_name>`). Common scripts might include `build`, `start`, `process:data`.
- **Deployment**: `vercel.json` suggests deployment via Vercel. Deployment likely involves building static files.
- **Local**: Use `run-local.bat` or `start-server.bat` (or equivalent `npm` script like `npm start`) for local testing. These likely use `serve.js`.

## 8. Key File Interactions (Linkage)

- **Data Flow**: Modifying raw data (`*.json`) -> **MUST** run processing script -> Updates `processed-data.js` -> Affects HTML pages and charts.
- **JS Logic**: Modifying `plan-data.js` or similar core logic files -> **MAY** require updates in HTML files (`splan.html`, `150plan.html`) that use its functions/data.
- **CSS**: Changes in `styles/styles.css` affect all pages.

## 9. Prohibitions

- **DO NOT** edit files in `node_modules/` or `dist/`.
- **DO NOT** edit `processed-data.js` (or similar generated files) manually. **ALWAYS** run the processing script after changing raw data.
- **DO NOT** introduce large frameworks (jQuery, React, etc.) without explicit approval.
- **DO NOT** add global variables unnecessarily.
- **DO NOT** commit large data files directly if they change frequently (consider `.gitignore` or alternative data fetching). Check file sizes.